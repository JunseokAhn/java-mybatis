

DROP TABLE BRIDGE;
CREATE TABLE BRIDGE
(
    BRIDGE_ID    NUMBER(18, 0)    NOT NULL, 
    CONSTRAINT BRIDGE_PK PRIMARY KEY (BRIDGE_ID)
);

DROP SEQUENCE BRIDGE_SEQ;
CREATE SEQUENCE BRIDGE_SEQ
START WITH 1
INCREMENT BY 1;


DROP TRIGGER BRIDGE_AI_TRG;
CREATE OR REPLACE TRIGGER BRIDGE_AI_TRG
BEFORE INSERT ON BRIDGE 
REFERENCING NEW AS NEW FOR EACH ROW 
BEGIN 
    SELECT BRIDGE_SEQ.NEXTVAL
    INTO :NEW.BRIDGE_ID
    FROM DUAL;
END;


DROP TABLE PRODUCER;
CREATE TABLE PRODUCER
(
    PRODUCER_ID    VARCHAR2(20)     NOT NULL, 
    PW             VARCHAR2(20)     NOT NULL, 
    NAME           VARCHAR2(15)     NOT NULL, 
    ADDRESS        VARCHAR2(150)    NULL, 
    PHONE          VARCHAR2(13)     NULL, 
    CONSTRAINT PRODUCER_PK PRIMARY KEY (PRODUCER_ID)
);

DROP TABLE CONSUMER;
CREATE TABLE CONSUMER
(
    CONSUMER_ID    VARCHAR2(20)     NOT NULL, 
    PW             VARCHAR2(20)     NOT NULL, 
    NAME           VARCHAR2(15)     NOT NULL, 
    ADDRESS        VARCHAR2(150)    NULL, 
    PHONE          VARCHAR2(13)     NULL, 
    CONSTRAINT CONSUMER_PK PRIMARY KEY (CONSUMER_ID)
);

DROP TABLE SYOUBINN;
CREATE TABLE SYOUBINN
(
    SYOUBINN_ID    NUMBER(18, 0)    NOT NULL, 
    NAME           VARCHAR2(15)     NOT NULL, 
    SYUURUI        VARCHAR2(150)    NULL, 
    PRICE          NUMBER(18, 0)    NOT NULL, 
    PRODUCER_ID    VARCHAR2(20)     NOT NULL, 
    S_INDATE       DATE             DEFAULT SYSDATE NOT NULL, 
    BRIDGE_ID      NUMBER(18, 0)    NOT NULL, 
    CONSTRAINT SYOUBINN_PK PRIMARY KEY (SYOUBINN_ID)
);

DROP SEQUENCE SYOUBINN_SEQ;
CREATE SEQUENCE SYOUBINN_SEQ
START WITH 1
INCREMENT BY 1;

DROP TRIGGER SYOUBINN_AI_TRG;
CREATE OR REPLACE TRIGGER SYOUBINN_AI_TRG
BEFORE INSERT ON SYOUBINN 
REFERENCING NEW AS NEW FOR EACH ROW 
BEGIN 
    SELECT SYOUBINN_SEQ.NEXTVAL
    INTO :NEW.SYOUBINN_ID
    FROM DUAL;
END;




ALTER TABLE SYOUBINN
    ADD CONSTRAINT FK_SYOUBINN_PRODUCER_ID_PRODUC FOREIGN KEY (PRODUCER_ID)
        REFERENCES PRODUCER (PRODUCER_ID);

ALTER TABLE SYOUBINN
    ADD CONSTRAINT FK_SYOUBINN_BRIDGE_ID_BRIDGE_B FOREIGN KEY (BRIDGE_ID)
        REFERENCES BRIDGE (BRIDGE_ID);


DROP TABLE TYUUMON;
CREATE TABLE TYUUMON
(
    TYUUMON_ID     NUMBER(18, 0)    NOT NULL, 
    CONSUMER_ID    VARCHAR2(20)     NOT NULL, 
    T_INDATE       DATE             DEFAULT SYSDATE NOT NULL, 
    BRIDGE_ID      NUMBER(18, 0)    NOT NULL, 
    CONSTRAINT TYUUMON_PK PRIMARY KEY (TYUUMON_ID)
);

DROP SEQUENCE TYUUMON_SEQ;
CREATE SEQUENCE TYUUMON_SEQ
START WITH 1
INCREMENT BY 1;

DROP TRIGGER TYUUMON_AI_TRG;
CREATE OR REPLACE TRIGGER TYUUMON_AI_TRG
BEFORE INSERT ON TYUUMON 
REFERENCING NEW AS NEW FOR EACH ROW 
BEGIN 
    SELECT TYUUMON_SEQ.NEXTVAL
    INTO :NEW.TYUUMON_ID
    FROM DUAL;
END;



ALTER TABLE TYUUMON
    ADD CONSTRAINT FK_TYUUMON_BRIDGE_ID_BRIDGE_BR FOREIGN KEY (BRIDGE_ID)
        REFERENCES BRIDGE (BRIDGE_ID);

ALTER TABLE TYUUMON
    ADD CONSTRAINT FK_TYUUMON_CONSUMER_ID_CONSUME FOREIGN KEY (CONSUMER_ID)
        REFERENCES CONSUMER (CONSUMER_ID);


